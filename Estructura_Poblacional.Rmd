---
title: "Estructura Poblacional"
author: "Claudia1930"
date: "2022-11-23"
output: 
 html_document:
   code_folding: hide
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE )
library(readxl)
library(dplyr)
library(tidyverse)
library(rstatix)
library(gt)
library(plotrix)

```

```{r}
knitr::include_graphics("QUETA.jpg")
```


#BASE DE DATOS 
```{r}
BD_General <- read_excel("BD_General_Cuencas.xlsx", 
         # col_types = c("numeric", "text", "numeric", 
         # "text", "text", "text", "text", "text", 
         # "numeric", "numeric", "numeric", 
         # "numeric", "text", "numeric", "text", 
         # "text", "text", "text", "numeric", 
         # "text", "text", "numeric", "numeric", 
         # "text", "text", "text", "text", "numeric", 
         # "text","text"), 
        skip = 2)
  

BD_General
```
#Composición de la tropa por Edad
```{r}
BD_General |> 
    group_by(Edad_r) |> 
    summarise(cantidad = n()) |> 
    mutate(proporcion = cantidad/sum(cantidad)*100,) %>%
gt() %>%
    fmt_number(
    columns =c(proporcion),
    decimals = 2,
    dec_mark = ",",
    sep_mark = "."
    )%>%
tab_header(title = "Cantidad y Porcentaje de animales según edad")


```


#Gráfico de la Composición de la tropa según Edad
```{r}
BD_General |> 
  group_by(Edad_r) |> 
  summarise(cantidad = n()) |> 
  mutate(proporcion = cantidad/sum(cantidad)*100,) %>%
  
ggplot() +
  geom_col(aes(x = Edad_r, y = proporcion, fill = Edad_r),position = "dodge", alpha = 0.8)+
  geom_text(aes(x = Edad_r, y = proporcion,label = proporcion), position =position_stack(), size=4, vjust=2, hjust=0.5, col="black")
```

#Composición de la tropa según Sexo
```{r}
BD_General |> 
  group_by(Sexo) |> 
  summarise(cantidad = n()) |> 
  mutate(proporcion = cantidad/sum(cantidad)*100) %>%
gt() %>%
  fmt_number(
    columns =c(proporcion),
    decimals = 2,
    dec_mark = ",",
    sep_mark = "."
    )%>%
  tab_header(title = "Frencuencia y Porcentaje de Machos, Hembras y Capones")
```

#composición de la tropa según Edad y Sexo
```{r}
BD_General |> 
  group_by(Sexo, Edad_r) |> 
  summarise(cantidad = n()) |> 
  mutate(proporcion = cantidad/sum(cantidad)*100) %>%
gt() %>%
  fmt_number(
    columns =c(proporcion),
    decimals = 2,
    dec_mark = ",",
    sep_mark = "."
    )%>%
  tab_header(title = "Frencuencia y Porcentaje de Machos, Hembras y Capones")
```


#Frecuencia y Porcentaje de tipo de Mecha

```{r}
BD_General |>
  group_by(TM_r) |> 
  summarise(cantidad = n()) |> 
  mutate(proporcion = cantidad/sum(cantidad)*100) %>%
  gt() %>%
  fmt_number(
    columns =c(proporcion),
    decimals = 2,
    dec_mark = ",",
    sep_mark = "."
    )%>%
  tab_header(title = "Frecuencia y Porcentaje de Tipo de Mecha")
```


#Frecuencia y Porcentaje de Color
```{r}
BD_General |>
  group_by(CM_r) |> 
  summarise(cantidad = n()) |> 
  mutate(proporcion = cantidad/sum(cantidad)*100) %>%
gt() %>%
  fmt_number(
    columns =c(proporcion),
    decimals = 2,
    dec_mark = ",",
    sep_mark = "."
    )%>%
  tab_header(title = "Frecuencia y Porcentaje de Color de Fibra")
```

#Tabla de Medidas Zoométricas y Condición Corporal
```{r}
BD_EP <- select(BD_General, "PT", "PH", "A", "Condición Corporal")
BD_EP
```
#Promedio de Medidas Zoometrícas y Condición Corporal
```{r}
group_by(BD_EP) %>%
  summarise_all(mean, na.rm = TRUE) %>%
  gt() %>%
  
tab_header(title = "Promedio de Medidas Zoométricas y Condición Corporal")
```

#Desvío Estándar de Medidas Zoométricas y Condición Corporal
```{r}
group_by(BD_EP) %>%
  summarise_all(sd, na.rm = TRUE) %>%
  gt() %>%
  
  tab_header(title = "Desvío Estándar de Medidas Zoométricas y Condición Corporal")
```

#Varianza de Medidas Zoométricas y Condición Corporal
```{r}
group_by(BD_EP) %>%
  summarise_all(var, na.rm = TRUE) %>%
  gt() %>%
  tab_header(title = "Varianza de Medidas Zoométricas y Condición Corporal")
```

#Error Estándar de Medidas Zoométricas y Condición Corporal
```{r}
std.error(BD_VT)
```

#Frecuencia y Porcentaje de Finura de Fibra
```{r}
BD_General |>
  group_by(FM) |> 
  summarise(cantidad = n()) |> 
  mutate(proporcion = cantidad/sum(cantidad)*100) %>%
gt() %>%
  fmt_number(
    columns =c(proporcion),
    decimals = 2,
    dec_mark = ",",
    sep_mark = "."
    )%>%
  tab_header(title = "Frecuencia y Porcentaje de Finura de Fibra")
```

#Frecuencia y Porcentaje de Morfotipo
```{r}
BD_General|>
  group_by(Morfotipo) |> 
  summarise(cantidad = n()) |> 
  mutate(proporcion = cantidad/sum(cantidad)*100) %>%
gt() %>%
  fmt_number(
    columns =c(proporcion),
    decimals = 2,
    dec_mark = ",",
    sep_mark = "."
    )%>%
  tab_header(title = "Frecuencia y Porcentaje de Morfotipo")
```

#Tabla de Finura de Fibra y Condición Corporal
```{r}
BD_EP1 <- select(BD_General, "Condición Corporal", "DM FLc2022")
BD_EP1
```

