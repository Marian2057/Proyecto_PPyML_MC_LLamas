---
title: "Estructura Poblacional"
author: "Claudia1930"
date: "2022-11-23"
output: 
 html_document:
   toc: TRUE
   toc_float: TRUE
   code_folding: hide
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE )
library(readxl)
library(dplyr)
library(tidyverse)
library(rstatix)
library(gt)
library(plotrix)
library(RcmdrPlugin.NMBU)
library(NbClust)
```

```{r}
knitr::include_graphics("QUETA.jpg")
```

# Introducción

La base de datos con la cual se trabajará, corresponde a un proceso de investigación/extensión con el objetivo de determinar la Estructura Poblacional de las llamas en la Argentina.

La Estructura Poblacional es una herramienta demográfica que consiste en realizar un relevamiento poblacional basándose en caracteres zootécnicos de los animales presentes en diferentes tropas a nivel de una determinada área y/o región.  La metodología mencionada tiene como principal objetivo determinar las principales características de “LA LLAMA ARGENTINA” y su POTENCIAL PRODUCTIVO.
En este caso, la caracterización y cuantificación de la oferta poblacional se realiza en la comunidades Aborígenes de la Provincia de Jujuy, más precisamente en los departamentos de Rinconada, Cochinoca y Yavi.



## Exploración de los datos

```{r}
BD_General <- read_excel("BD_General.xlsx", 
    col_types = c("numeric", "text", "numeric", 
        "text", "text", "text", "text", "text", 
        "numeric", "numeric", "numeric", 
        "numeric", "text", "numeric", "text", 
        "text", "text", "text", "numeric", 
        "text", "text", "numeric", "numeric", 
        "text", "text", "text", "text", "numeric", 
        "text"))
BD_General
```
Se seleccionan las variables sobre las cuales se aplicará PCA
```{r}
BD_EP1 <- BD_General %>% 
  
  dplyr::select( Edad_r, Sexo, Condicion_Corporal, DM_FLc2022)%>% 
  rename(Edad_Real= Edad_r, Diametro_Fibra = DM_FLc2022) 
  
BD_EP1
```
Se cuenta con 4 variables y 1474 observaciones, donde cada observación corresponde a la descripción de cada llama segun el sexo, la edad, la condicion corporal y la calidad de la fibra


Análisis de la población muestra


### Composición de la tropa por Edad
```{r}
BD_EAg <- BD_EP1 |> 
  group_by(Edad_Real) |> 
  summarise(cantidad = n()) |> 
  mutate(proporcion = cantidad/sum(cantidad)*100,
      proporcion=round(proporcion, 2)   )%>%

gt() %>%
  tab_header(title = "Cantidad y Porcentaje de animales según edad")
BD_EAg
```
```{r}

```

### Gráfico de la Composición de la tropa según Edad
```{r}
BD_EP1 |> 
group_by( Edad_Real) |> 
  summarise(cantidad = n()) |> 
  mutate(proporcion = cantidad/sum(cantidad)*100, proporcion=round(proporcion, 2) ) %>%
ggplot() +
  geom_col(aes(x = Edad_Real, y = proporcion, fill = Edad_Real),position = "dodge", alpha = 0.8)
```

### Composición de la tropa según Sexo
```{r}
BD_EP1 |> 
  group_by(Sexo) |> 
  summarise(cantidad = n()) |> 
  mutate(proporcion = cantidad/sum(cantidad)*100, proporcion=round(proporcion, 2) ) %>%
gt() %>%
  tab_header(title = "Frencuencia y Porcentaje de Machos, Hembras y Capones")
```

### Composición de la tropa según Edad y Sexo
```{r}
BD_EP1 |> 
  group_by(Sexo, Edad_Real) |> 
  summarise(cantidad = n()) |> 
  mutate(proporcion = cantidad/sum(cantidad)*100, proporcion=round(proporcion, 2) ) %>%
gt() %>%
  tab_header(title = "Frencuencia y Porcentaje de Machos, Hembras y Capones")
```





### Frecuencia y Porcentaje de Finura de Fibra
```{r}
 # BD_EP1 %>% 
 #   group_by(FM) %>%   #esta variable no la estamos trabajando
 #   summarise(cantidad = n()) %>%  
 #   mutate(proporcion = cantidad/sum(cantidad)*100, proporcion=round(proporcion, 2) ) %>%  
 # gt() %>% 
 # tab_header(title = "Frecuencia y Porcentaje de Finura de Fibra") 
```




### Tabla de Finura de Fibra y Condición Corporal

```{r}

BD_EP4 <- dplyr::select(BD_EP1, "Condicion_Corporal", "Diametro_Fibra", "Sexo")
  
head(BD_EP4)
```

```{r}
BD_EP4 |> 
  group_by(Sexo) |> 
  summarise(cantidad = n()) |> 
  mutate(proporcion = cantidad/sum(cantidad)*100, proporcion=round(proporcion, 2) ) %>%
gt() %>%
  tab_header(title = "Frencuencia y Porcentaje de Machos, Hembras y Capones")
  
```
std.error(BD_EP)
```{r}
BD_EP4 |> 
  group_by(Sexo) |> 
  summarise(cantidad = n()) |> 
  mutate(proporcion = cantidad/sum(cantidad)*100, proporcion=round(proporcion, 2) ) %>%
 ggplot(aes(x = cantidad, y = proporcion)) +
  geom_col(aes(fill = Sexo))
  
```
### En el gráfico precedente se observa que el 86,8% de los datos corresponden a la categoria "Hembras". Sin embargo se debe centrar el análisis en la calidad de fibra de los machos que representan el 6,91% , esto debido a que cada macho reproductor sirve en promedio a 30 hembras.

### Analizar la Condición Corporal de los machos
```{r}
BD_EP2 <- dplyr::select(BD_EP1, "Condicion_Corporal", "Diametro_Fibra", "Edad_Real")
BD_EP2
```
```{r}
ggplot(BD_EP1, aes(x=Edad_Real, y=Diametro_Fibra)) +
  geom_point(aes(color = Edad_Real))
 
  
```

```{r}
ggplot(BD_EP1, aes(x=Edad_Real, y=Diametro_Fibra)) +
  geom_boxplot()
```

#Análisis de la Relación entre Edad y Diámetro de la fibra
```{r}
ggplot(BD_EP1, aes(x=Edad_Real, y=Diametro_Fibra)) +
  geom_violin(aes(color = Edad_Real, fill = Edad_Real))
```
#


La Condición Corporal de los machos se puede calificar de ............, la importancia del análisis es poder concluir si se encuentran en condiciones de servir como promedio de 30 hembras.


### Analizar la Condición Corporal de los machos

```{r}
BD_EP2 <- dplyr::select(BD_EP1, "Condicion_Corporal", "Diametro_Fibra")
BD_EP2
```

```{r}
BD_EP2%>%
group_by(Condicion_Corporal) %>%
  summarise(cantidad = n()) |> 
  mutate(proporcion = cantidad/sum(cantidad)*100) %>%
  gt() %>%
  tab_header(title = "Promedio de Condición Corporal, Finura de Fibra")
```
  
  

